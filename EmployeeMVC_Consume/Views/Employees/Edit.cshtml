@model EmployeeMVC_Consume.ViewModels.EmployeeVM
<h2>Edit Employee</h2>

<form asp-action="Edit" method="post">
    <div class="form-group">
        <label asp-for="Name" class="control-label"></label>
        <input type="hidden" class="" asp-for="Id" />
        <input asp-for="Name" class="form-control" />
        <span asp-validation-for="Name" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="DepartmentId" class="control-label">Department</label>
        @* <input type="hidden" class="" asp-for="DepartmentId" /> *@
        <select asp-for="DepartmentId" class="form-control" id="DepartmentId">
            <option value=""></option>

        </select>
        <span asp-validation-for="DepartmentId" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="JobRoleId" class="control-label">Position</label>
        @* <input type="hidden" class="" asp-for="JobRoleId" /> *@
        <select asp-for="JobRoleId" class="form-control" id="JobRoleId" >
            <option value=""></option>

        </select>
        <span asp-validation-for="JobRoleId" class="text-danger"></span>
    </div>
    <div class="form-group mt-3">
        <input type="submit" value="Update" class="btn btn-primary" />
        <a asp-action="Index" class="btn btn-secondary">Back to List</a>

    </div>

</form>

@section Scripts {
    <script>
        $(document).ready(function(){
            $.ajax({
            url: 'https://localhost:7164/api/Departments/',
            type: 'GET',
            contentType: 'application/json',
            success: function (data) {
                console.log(data);
                $.each(data, function (index, department) {
                    $("#DepartmentId").append('<option value="' + department.Id + '">' + department.Name + '</option>')
                });
            },
            error: function (xhr, status, error) {
                console.log('Error saving employee data:', error);
            }
            });
            $.ajax({
            url: 'https://localhost:7164/api/JobRoles/',
            type: 'GET',
            contentType: 'application/json',
            success: function (data) {
                console.log(data);
                $.each(data, function (index, jobRole) {
                    $("#JobRoleId").append('<option value="' + jobRole.Id + '">' + jobRole.JobTitle + '</option>')
                });
            },
            error: function (xhr, status, error) {
                console.log('Error saving employee data:', error);
            }
            });
            
        });
    </script>
}
